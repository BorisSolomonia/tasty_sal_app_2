:80 {
  log {
    output stdout
    format console
  }

  # Static frontend
  reverse_proxy nine-tones-app:3000

  # API under same origin - preserve /api prefix
  handle /api/* {
    reverse_proxy nine-tones-app:3001
  }

  @health {
    path /health
  }
  respond @health 200

  encode gzip zstd
}